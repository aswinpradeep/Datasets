# -*- coding: utf-8 -*-
"""En-Hi_ParrllelCleaner.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1xevjp52smlc3uHZH0MPpWm6X-ihXVviP
"""

print("hello")

!pip install langdetect

import pathlib
import matplotlib.pyplot as plt
import numpy as np
import pandas as pd
from langdetect import detect ,detect_langs ,DetectorFactory
DetectorFactory.seed = 0

dataset_path1="https://github.com/aswinpradeep/Datasets/blob/master/pib-parallel-sentences-en-hi-2020%20-%202020.csv?raw=true"

column_names = ['ENGLISH','HINDI']
df = pd.read_csv(dataset_path1, names=column_names, skipinitialspace=True)
df = df[1:]
df

df['HINDI'].nunique()

df = df.drop_duplicates(subset='HINDI', keep="first")
df = df.drop_duplicates(subset='ENGLISH', keep="first")

df

df["ENGLISH"] =  df['ENGLISH'].str.replace('[^\x00-\x7F]','')
df["ENGLISH"] =  df['ENGLISH'].str.replace(';','.')
df["HINDI"] =  df['HINDI'].str.replace(';','.')

regList=[]
regList.append('^[0-9]+\.')
regList.append('^[0-9]\.')
regList.append('^[(][0-9]+[)]')
regList.append('^[0-9]+[)]')
regList.append('^[(][a-zA-Z][)]')
regList.append('^[a-zA-z]\.')
regList.append('^[a-zA-z][)]')
regList.append('^[IVXLCDM]+\.')
regList.append('^[(][IVXLCDM]+[)]')
regList.append('^[ivxlcdm]+\.')
regList.append('^[(][ivxlcdm]+[)]')
regList.append('^[ivxlcdm]+[)]')
regList.append('^-')
regList.append('^·')
regList.append('^●')
regList.append('^o')
regList.append('^Ø')
regList.append('^•')
regList.append('  +')


for reg in regList:
    df['HINDI']=df['HINDI'].str.replace(reg,'')

for reg in regList:
    df['ENGLISH']=df['ENGLISH'].str.replace(reg,'')

df['HINDI']=df['HINDI'].str.strip()
df['ENGLISH']=df['ENGLISH'].str.strip()
englishlist=df['ENGLISH'].to_list()
hindilist=df['HINDI'].to_list()

newlanglist1 = []
nonengcount1=0
for title in englishlist:
  try:
    detlan=detect(title)
    if(detlan!='en'):
      newlanglist1.append("NA")
      nonengcount1=nonengcount1+1
      print(title)
    elif(detlan=='en'):
      newlanglist1.append(title)

     
  except:
    newlanglist1.append("NA")
    print(title)

newlanglist2 = []
nonengcount2=0
for title in hindilist:
  try:
    detlan=detect(title)
    if(detlan!='hi'):
      newlanglist2.append("NA")
      nonengcount2=nonengcount2+1
      print(title)
    elif(detlan=='hi'):
      newlanglist2.append(title)
     
  except:
    newlanglist2.append("NA")
    print(title)

for i in range(len(newlanglist1)):
    if(newlanglist1[i]=="NA" or newlanglist2[i]=="NA"):
      newlanglist1[i]=""
      newlanglist2[i]=""

len(newlanglist1)

df.isnull().sum()

df['NEWENG']=newlanglist1
df['NEWHIN']=newlanglist2

df['NEWENG'].replace('', np.nan, inplace=True)
df['NEWHIN'].replace('', np.nan, inplace=True)

df.dropna(subset=['NEWENG'], inplace=True)

del df['ENGLISH']
del df['HINDI']

from google.colab import files
df.to_csv('final_en_hi_2020.csv', index=False)